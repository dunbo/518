<script>function searchDevice(){	$.ajax({		url: '__APP__/Public/showDevice/callback/{$callback}',		data: {keyword: $('#keyword').val()},		type: 'POST',		success: function(data){			var len = $('.TB_ajaxContent').length			if (len > 0) {				$('#TB_ajaxContent'+window_list[len-1]).html(data)			} else {				$('#TB_ajaxContent').html(data)			}			//$('#TB_ajaxContent').html(data)		}	});}function allDevice(){	$.ajax({		url: '__APP__/Public/showDevice?callback={$callback}',		data: {all: 1},		type: 'POST',		success: function(data){			var len = $('.TB_ajaxContent').length			if (len > 0) {				$('#TB_ajaxContent'+window_list[len-1]).html(data)			} else {				$('#TB_ajaxContent').html(data)			}			//$('#TB_ajaxContent').html(data)		}	});}function selectAll(){	$("tr:visible input[name^=did]").each(function(){		this.checked = true;	})}function selectUnAll(){    $("tr:visible input[name^=did]").each(function(){		this.checked = !$(this).attr("checked");	})}function selectDevice(obj){	if (obj.checked == true) {		var item = $('<label class="l_did_' + $(obj).val() + '">' + $('.l_did_' + $(obj).val()).html() + '</label>');		item.find('input').attr('checked', true);		$('#c_device_res').append(item);		$.get('__APP__/Public/setDevice/act/add/did/' + $(obj).val() + '/dname/' + $(obj).attr('alt'));	} else {		$('#c_device_res .l_did_' + $(obj).val() + ' input:checked').attr('checked', false);        $('#c_device_table .l_did_' + $(obj).val() + ' input:checked').attr('checked', false);		console.log($('.l_did_' + $(obj).val() + ' input'));		$.get('__APP__/Public/setDevice/act/del/did/' + $(obj).val() );		$('#c_device_res .l_did_' + obj.value).remove();	}}</script><form id="channelForm"><table width="100%" border="1"><tr><td><input type="text" id="keyword" name="keyword" value="{$keyword}"/></td><td><input type="button" value="搜索机型" onclick="searchDevice()"/><input type="button" value="所有机型列表" onclick="allDevice()"/></td></tr><tr><td colspan="2"><input type="button" value="提交指定机型" onclick="{$callback}()"/><!-- <input type="button" value="全选" onclick="selectAll()"/><input type="button" value="反选" onclick="selectUnAll()"/>--></td></tr></table><br>选中机型<div id='c_device_res'>	<?php foreach($selected_devices as $k => $v):?>		<label class="l_did_<?php echo $k ?>">		<input type="checkbox" name="did[]" value="<?php echo $k ?>" onclick='selectDevice(this)' alt='<?php echo $v ?>' checked='true'/><?php echo $v ?>		</label>	<?php endforeach; ?></div><hr><br><table id='c_device_table' width="100%" border="1">	<tr>	<?php $i=0; ?>	<?php foreach($devices as $device):?>	<?php $i++; ?>		<td>		<label class="l_did_<?php echo $device['did'] ?>">		<input type="checkbox" name="did[]" value="<?php echo $device['did'] ?>" onclick='selectDevice(this)' alt='<?php echo $device['dname'] ?>' <?php if(isset($selected_devices[$device['did']])):?>checked='true'<?php endif?>/><?php echo $device['dname'] ?>		</label>		</td>		<?php if ($i % 4 ==0): ?></tr><tr><?php endif?>	<?php endforeach; ?></table><input type="button" value="提交选中机型" onclick="{$callback}()"/></form><?php if (!empty($_GET['ready'])) :?><script><?php echo $_GET['ready'];?>();</script><?php endif;?>