var Azfd=(function(){function Construct(){this.port_arr=[12345,23456];this.invoke_count=0;this.ping_count=0;this.max_request=this.port_arr.length;this.has_market=false;this.url_prefix='http://fd.anzhi.com';this.lock=false;this.success=null;this.error=null;this.container=document.getElementById("az_spirit");this.share_download=function(b,c){if(this.lock){return}this.lock=true;this.has_market=false;this.invoke_count=0;this.ping_count=0;if(this.container==null){this.container=document.createElement('div');this.container.id='az_spirit';document.body.appendChild(this.container)}this.container.innerHTML="";if(!this.port_arr){return}var d='';var e='';e=b['type'];if(typeof(b['callback'])!='undefined'){this.success=b['callback']}else{this.success=null}var f='';for(var k in b){if(k!='callback'){f+='&'+k+'='+b[k]}if(k!='type'&&k!='callback'){if(d==''){d+='?'+k+'='+b[k]}else{d+='&'+k+'='+b[k]}}}var g='';var h=true;for(var k in c){if(k=='disable_auto'){h=false}else{g+='&'+k+'='+c[k]}}var i=this;this.invoke_client(f,function(){i.invoke_count++;if(i.invoke_count>=i.max_request){if(!i.has_market){i.invoke_scheme(e,d);setTimeout(function(){f='&type=ping&id=unknown';i.invoke_client(f,function(){i.ping_count++;if(i.ping_count>=i.max_request){i.ping_count=0;i.lock=false;if(!i.has_market){var r=Math.floor(Math.random()*1000000000);var a='/fast.php?r='+r+g;if(i.error!=null){i.error(a)}else if(h){window.location.href=a}}}})},1000)}else{i.lock=false}}});i.lock=false};this.invoke_client=function(a,b){var c=0;var d='';for(var i=0;i<this.max_request;i++){c=Math.floor(Math.random()*1000000000);d=this.url_prefix+':'+this.port_arr[i]+'/query?callback=Azfd.invoke_callback&r='+c+a;var m=document.createElement("script");m.type='text/javascript';m.src=d;m.async=true;m.onerror=m.onload=function(){b()};this.container.appendChild(m)}};this.invoke_scheme=function(a,b){var c=navigator.userAgent.toLowerCase();var d=/aliapp|360 aphone|weibo|windvane|ucbrowser/.test(c);var e=/chrome|samsung/.test(c);var f=/android|adr/.test(c)&&!(/windows phone/.test(c));var g=!d&&e&&f;if(c.indexOf('m353')>-1&&!d){g=false}var h='anzhimarket';var i='cn.goapk.market';if(!g){var j=h+'://'+a+b;var k=document.createElement('iframe');k.src=j;k.style.display='none';this.container.appendChild(k)}else{var l='intent://'+a+b+'#Intent;scheme='+h+';package='+i+';end';var m=document.getElementById('openIntentLink');if(!m){m=document.createElement('a');m.id='openIntentLink';m.style.display='none';this.container.appendChild(m)}m.href=l;m.dispatchEvent(this.customClickEvent())}};this.customClickEvent=function(){var a;if(window.CustomEvent){a=new window.CustomEvent('click',{canBubble:true,cancelable:true})}else{a=document.createEvent('Event');a.initEvent('click',true,true)}return a};this.invoke_callback=function(){this.has_market=true;if(this.success!==null){var a=arguments[0];var b=parseInt(arguments[1]);var c=arguments[2];var d=arguments[3];if(typeof(this.success)=='function'){this.success(a,b,c,d)}else if(typeof(this.success)=='string'){window[this.success](a,b,c,d)}}}}var n=new Construct();return n})();