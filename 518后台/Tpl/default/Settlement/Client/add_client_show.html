<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style>

.red{color:red;}
.green{color:green;}
.box_input tr td input{height:31px !important;}
</style>
<script type="text/javascript" src="/Public/js/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/school/js/jquery.zxxbox.3.0.js"></script>
<link rel="stylesheet" href="/Public/css/tablelist.css" type="text/css" media="screen" />
</head>
<body>
<if condition="$client.id gt 0"><form action="__URL__/edit_client_do" method="post"><else /> <form action="__URL__/add_client_do" method="post"></if>

<input type="hidden" name="url_suffix" value="{$url_suffix}"/>
<input type="hidden" id="client_id" name="id" value="{$client.id}"/>
	<table class="yahei box_input">
		<tr>
			<td style="padding:5px 20px;text-align:left !important;" colspan="3"><font color=red></font>应用推广><span onClick="window.history.go(-1)">客户管理</span>><if condition="$client.id gt 0">编辑客户<else /> 添加客户</if></td>
		</tr>
		<tr>
			<td style="padding:5px 20px;text-align:left !important;"><font color=red></font>基本信息</td>
		</tr>
		
		<tr>
            <td style="padding:5px 20px;text-align:left !important;"><font color=red>*</font>客户名称：</td>
			<td style="padding:5px 20px;text-align:left !important;"><input type="text" name="client_name" style="width:200px;" id="input_client_name" value="{$client.client_name}"/></td>
			<!-- <td class="" style="padding:5px 20px;text-align:left !important;"></td> -->
			<td style="padding:5px 20px;text-align:left !important;"><font color=red>*</font>客户类型：</td>
			<td style="padding:5px 20px;text-align:left !important;">
			<select name="client_type" id="input_client_type" style='width:207px;height:35px;'>
					<option value="0" <?php if($client['client_type']==0){echo "selected='selected'";}?>>未选择</option>
					<option value="1" <?php if($client['client_type']==1){echo "selected='selected'";}?>>直投</option>
					<option value="2" <?php if($client['client_type']==2){echo "selected='selected'";}?>>代理</option>
				</select>
			</td>
			<!-- <td class="" style="padding:5px 20px;text-align:left !important;"></td> -->
		</tr>
		<tr>
			<td style="padding:5px 20px;text-align:left !important;"><font color=red></font></td>
			<td style="padding:5px 20px;text-align:left !important;color:red;"><div id='client_name_error'></div></td>
			<td style="padding:5px 20px;text-align:left !important;"></td>
			<td style="padding:5px 20px;text-align:left !important;color:red;"><div id='cpd_client_type_error'></div></td>
		</tr>
		<tr>
			<td  colspan="4" style="padding:0px 0px;text-align:left !important;"><hr size=1 style="COLOR:black;border-style:;width:669px;color:black"> </td>
		</tr>
		<tr>
			<td style="padding:5px 20px;text-align:left !important;"><font color=red></font>CPT广告</td>
		</tr>
		<tr>
			<td style="padding:5px 20px;text-align:left !important;">联系人：</td>
			<td style="padding:5px 20px;text-align:left !important;"><input type="text" name="contact_name" style="width:200px;" id="input_contact_name" value="{$client.contact_name}"/></td>
			<!-- <td class="" style="padding:5px 20px;text-align:left !important;"></td> -->
			<td style="padding:5px 20px;text-align:left !important;">联系方式：</td>
			<td style="padding:5px 20px;text-align:left !important;"><input type="text" name="contact_phone" style="width:200px;" id="input_contact_phone" value="{$client.contact_phone}"/></td>
			<!-- <td class="" style="padding:5px 20px;text-align:left !important;"></td> -->
		</tr>
		<tr>
			<td style="padding:5px 20px;text-align:left !important;"><font color=red></font></td>
			<td style="padding:5px 20px;text-align:left !important;color:red;"><div id='contact_name_error'></div></td>
			<td style="padding:5px 20px;text-align:left !important;"></td>
			<td style="padding:5px 20px;text-align:left !important;color:red;"><div id='contact_phone_error'></div></td>
		</tr>
		<tr>
			<td  colspan="4" style="padding:0px 0px;text-align:left !important;"><hr size=1 style="COLOR:black;border-style:;width:669px;color:black"> </td>
		</tr>
		<tr>
			<td style="padding:5px 20px;text-align:left !important;"><font color=red></font>CPD广告</td>
		</tr>
		<tr>
			<td style="padding:5px 20px;text-align:left !important;"><font color=red>*</font>公司名称：</td>
			<td style="padding:5px 20px;text-align:left !important;"><input type="text" name="cpd_company" style="width:200px;" id="input_cpd_company" value="{$client.cpd_company}"/></td>
			<!-- <td class="" style="padding:5px 20px;text-align:left !important;"></td> -->
			<td style="padding:5px 20px;text-align:left !important;"><font color=red>*</font>公司地址：</td>
			<td style="padding:5px 20px;text-align:left !important;"><input type="text" name="cpd_company_address" style="width:200px;" id="input_cpd_company_address" value="{$client.cpd_company_address}"/></td>
			<!-- <td class="" style="padding:5px 20px;text-align:left !important;"></td> -->
		</tr>
		<tr>
			<td style="padding:3px 20px;text-align:left !important;"><font color=red></font></td>
			<td style="padding:3px 20px;text-align:left !important;color:red;"><div id='cpd_company_error'></div></td>
			<td style="padding:3px 20px;text-align:left !important;"></td>
			<td style="padding:3px 20px;text-align:left !important;color:red;"><div id='cpd_company_address_error'></div></td>
		</tr>
		<tr>
			<td style="padding:5px 20px;text-align:left !important;"><font color=red>*</font>联系人：</td>
			<td style="padding:5px 20px;text-align:left !important;"><input type="text" name="cpd_contact_name" style="width:200px;" id="input_cpd_contact_name" value="{$client.cpd_contact_name}"/></td>
			<!-- <td class="" style="padding:5px 20px;text-align:left !important;"></td> -->
			<td style="padding:5px 20px;text-align:left !important;"><font color=red>*</font>联系方式：</td>
			<td style="padding:5px 20px;text-align:left !important;"><input type="text" name="cpd_contact_phone" style="width:200px;" id="input_cpd_contact_phone" value="{$client.cpd_contact_phone}"/></td>
			<!-- <td class="" style="padding:5px 20px;text-align:left !important;"></td> -->
		</tr>
		<input type="hidden" name='dev_id' value="{$client.dev_id}" id='dev_id'>
		<tr>
			<td style="padding:3px 20px;text-align:left !important;"><font color=red></font></td>
			<td style="padding:3px 20px;text-align:left !important;color:red;"><div id='cpd_contact_name_error'></div></td>
			<td style="padding:3px 20px;text-align:left !important;"></td>
			<td style="padding:3px 20px;text-align:left !important;color:red;"><div id='cpd_contact_phone_error'></div></td>
		</tr>
	</table>
	<!-- <table class="yahei box_input">
		<tr>
			<td style="padding:5px 5px 5px 20px;text-align:left !important;" rowspan="2"><font color=red>*</font>数据关联开发者账号：<td><div style="margin-top:20px;"><input type="button"  onClick="javascript:$('#append_parent_two').zxxbox();$('#sel_dev_name').html('');$('#dev_name').val('');" value="关联"></button></div></td> 
		</tr>
		<tr>
			<td><span id='dev_sel_id'><if condition="$client.dev_id gt 0">{$client.dev_name} &nbsp;&nbsp;&nbsp;&nbsp;<image src='__PUBLIC__/images/error_icon.png' onclick='del_dev_name()'/><else /> </if></span></td> 
		</tr>
	</table> -->
	<div style="margin:10px auto;padding:0px 30px;">
	<button class="btn btn-success yahei" type="submit" style="padding-left:20px;padding-right:20px;margin-left:100px;" onClick="javascript:return checkBeforeSubmit();">保存</button>
	<button class="btn btn-default yahei" type="button" onClick="window.history.go(-1)"style="padding-left:20px;padding-right:20px;margin-left:30px;">取消</button>
	</div>
</form>
		<div id="append_parent_two" style="display:none;width:350px;" >
			<div style='padding-left:80px;border-bottom:1px solid #ccc;padding-bottom:5px;padding-top:10px;'>关联查看数据的开发者名称</div><br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;开发者名称：<input type="text" name="dev_name" style="width:190px;" id="dev_name" onkeyup="show_dev_name(this)" autocomplete="off"/>
			<div id='sel_dev_name'></div>
			<div style="padding-top:30px;padding-bottom:10px;">
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" value="确定" style="width:80px;" onclick="sel_ok()">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" value="取消" style="width:80px;" onclick="javascript:$('#dev_name').val('');$('#sel_dev_name').html('');$('#dev_name').attr('alt','');$('#zxxBlank').click();"></div>
		</div>
<script>
$(function(){
	//判断用户输入的客户名是否已经存在
	$("#input_client_name").change(function(){
		if($(this).val() == "" || $(this).val() == undefined)
		{
			// $(this).parent().next().text("请填写客户名称!").addClass('red');
			$("#client_name_error").html('请填写客户名称!');
			// $(this).css({border:"1px solid red"});
			return ;
		}
		var client_name = $(this).val();
		$.ajax({
			url:"__URL__/ajax_check_client_name",
			type:"post",
			dateType:"html",
			data:"client_name="+client_name,
			success:function(returnData){
				//处理返回数据
				if(returnData == "3")
				{
					// $("#input_client_name").parent().next().text("该客户已存在!").addClass('red');
					$("#client_name_error").html('该客户已存在!');
					// $("#input_client_name").css({border:"1px solid red"});
					return ;
				}else{
					// $("#input_client_name").parent().next().text("");
					$("#client_name_error").html('');
					// $("#input_client_name").css({border:"1px solid lightgray"});
					return ;
				}
			}
		});
	});
})
function checkBeforeSubmit()
{
	var i = 1;
	if($("#input_client_name").val() == "" || $("#input_client_name").val().length == 0)
	{
		$("#client_name_error").html('请填写客户名称!');
		i = 0;
	}else{
		$("#client_name_error").html('');
	}
	
	if($("#input_contact_name").val().length >10)
	{
		$("#contact_name_error").html('联系人名称10个字符以内!');
		i = 0;
	}else{
		$("#contact_name_error").html('');
	}
	if($("#input_contact_phone").val().length >20)
	{
		$("#contact_phone_error").html('联系人电话20个字符以内!');
		i = 0;
	}else{
		$("#contact_phone_error").html('');
	}
	
	if($("#input_cpd_contact_name").val().length>10||$("#input_cpd_contact_name").val()=='')
	{
		$("#cpd_contact_name_error").html('联系人名称10个字符以内!');
		i = 0;
	}else{
		$("#cpd_contact_name_error").html('');
	}
	
	if($("#input_cpd_contact_phone").val().length >20||$("#input_cpd_contact_phone").val()=='')
	{
		$("#cpd_contact_phone_error").html('联系人电话20个字符以内!');
		i = 0;
	}else{
		$("#cpd_contact_phone_error").html('');
	}
	
	if($("#input_cpd_company").val()=='')
	{
		$("#cpd_company_error").html('公司名称不能为空!');
		i = 0;
	}else{
		$("#cpd_company_error").html('');
	}
	
	if($("#input_cpd_company_address").val()=='')
	{
		$("#cpd_company_address_error").html('公司地址不能为空!');
		i = 0;
	}else{
		$("#cpd_company_address_error").html('');
	}
	
	if($("#input_client_type").val()==0)
	{
		$("#cpd_client_type_error").html('客户类型未选择!');
		i = 0;
	}else{
		$("#cpd_client_type_error").html('');
	}
	
	if(i == 0)
	{
		return false;
	}
	else
	{
		return true;
	}

}

function show_dev_name(obj){
	var dev_name=$(obj).val();
	if(!dev_name){
		return;
	}
	$.ajax({
			url:"__URL__/show_dev_name",
			type:"post",
			dateType:"json",
			data:"dev_name="+dev_name,
			success:function(json){
				var json=eval('('+json+')');
				if(json!=1){
					str="<ul id='search_pop' style='display: none;list-style:none;margin-top:0px;'>";
						for(var i=0;i < json.length; ++i) {
							str+="<li>";
							str+="<div style='margin-left:64px;margin-right:52px;border:1px solid #ccc;color:blue' alt='"+json[i]['dev_id']+"' onClick='select_dev_id(this)'>"+json[i]['dev_name']
							str+="</div></li>";
							if(json[i]['dev_name']==$('#dev_name').val()){
								$('#dev_name').attr('alt',json[i]['dev_id']);
							}
						}
						str+="</ul>";
						$('#sel_dev_name').html(str);
						$('#search_pop').show();
					}else{
						$('#sel_dev_name').html("");
					}
					
				}
		});

}
function select_dev_id(obj){
	var dev_name=$(obj).html();
	var dev_id=$(obj).attr('alt');
	$('#dev_name').val(dev_name);
	$('#dev_name').attr('alt',dev_id);
	$('#sel_dev_name').html("");
}
function sel_ok(){
	var dev_id=$('#dev_name').attr('alt');
	$('#dev_id').val(dev_id);
	if(dev_id){
		$('#dev_sel_id').html($('#dev_name').val()+"&nbsp;&nbsp;&nbsp;&nbsp;<image src='__PUBLIC__/images/error_icon.png' onclick='del_dev_name()'/>");
		$('#dev_sel_id').show();
	}else{
		$('#dev_sel_id').html(' ');
	}
	$('#dev_name').attr('alt','');
	$('#dev_name').val("");
	$('#sel_dev_name').html('');
	$('#zxxBlank').click();
}
// function dev_name_hide(){
// 	$('#sel_dev_name').html("");
// 	$('#dev_name').val("");
// }
function del_dev_name(){
	$('#dev_id').val(0);
	$('#dev_sel_id').hide();
}
</script>
</body>
</html>