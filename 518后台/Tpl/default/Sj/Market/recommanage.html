<include file="../Public/header" />
<style type="text/css">
table,tr,td {margin:0;padding:0;}
.cls {background:#000;width:900px;}
.cls td {background:#fff;}
.cls input {height:22px;font-size:12px;}
.td1 {width:25%;text-align:center;font-weight:bold;font-size:13px;height:30px;}
.td2 {text-align:center;height:30px;font-size:12px;}
.cls a {text-decoration:none;color:blue;}
.td3 {padding-left:5px;}
</style>
<body>
<h2>推荐文案管理</h2>
<P>
<P>
<center>
<table border="0" cellspacing="1" cellpadding="0" class="cls">
	<tr>
		<td colspan="4" style="background:#E4E4E4;height:30px;"><span style="font-size:13px;font-weight:bold;">推荐信息列表：</span><span style="float:right;margin-right:10px;"><button style="margin-right:10px;" onclick="window.location='/index.php/Sj/Market/recomconf';if(window.ActiveXObject) window.event.returnValue = false;">配置页面</button><button onclick="popup('_recom')">添加推荐信息</button></span></td>
	</tr>
	<tr>
		<td class="td1" style="background:#FFFFCC;cursor:pointer;" onclick="showtb(1)" id="td1">普通推荐文案</td>
		<td class="td1" style="background:#E4E4E4;cursor:pointer;" onclick="showtb(2)" id="td2">已安装软件全部过滤推荐文案</td>
		<td class="td1" style="background:#E4E4E4;cursor:pointer;" onclick="showtb(3)" id="td3">等待加载推荐文案</td>
		<td class="td1" style="background:#E4E4E4;cursor:pointer;" onclick="showtb(4)" id="td4">下载、更新为空推荐文案</td>
	</tr>
</table>

<div id="table1">
<table border="0" cellspacing="1" cellpadding="0" class="cls">
	<tr>
		<td class="td2" style="background:#F2F2F2;">序号</td>
		<td class="td2" style="background:#F2F2F2;">文案信息内容</td>
		<td class="td2" style="background:#F2F2F2;">添加时间</td>
		<td class="td2" style="background:#F2F2F2;">操作管理</td>
	</tr>
	<volist name="recom1" id="vo">
	<tr>
		<td class="td2">{$vo.id|default='&nbsp;'}</td>
		<td class="td3" id="id_{$vo.id}">{$vo.recom_cont|default='&nbsp;'}</td>
		<td class="td2">{$vo.postdate|default='&nbsp;'}</td>
		<td class="td2"><span style="margin-right:7px;"><a href="javascript:void(0);" onclick="Edit(1,{$vo.id})">【编辑】</a></span><a href="javascript:void(0);" onclick="Delete(1,{$vo.id})">【删除】</a></td>
	</tr>
	</volist>
</table>
</div>

<div id="table2" style="display:none;">
<table border="0" cellspacing="1" cellpadding="0" class="cls">
	<tr>
		<td class="td2" style="background:#F2F2F2;">序号</td>
		<td class="td2" style="background:#F2F2F2;">文案信息内容</td>
		<td class="td2" style="background:#F2F2F2;">添加时间</td>
		<td class="td2" style="background:#F2F2F2;">操作管理</td>
	</tr>
	<volist name="recom2" id="vo">
	<tr>
		<td class="td2">{$vo.id|default='&nbsp;'}</td>
		<td class="td3" id="id_{$vo.id}">{$vo.recom_cont|default='&nbsp;'}</td>
		<td class="td2">{$vo.postdate|default='&nbsp;'}</td>
		<td class="td2"><span style="margin-right:7px;"><a href="javascript:void(0);" onclick="Edit(2,{$vo.id})">【编辑】</a></span><a href="javascript:void(0);" onclick="Delete(2,{$vo.id})">【删除】</a></td>
	</tr>
	</volist>
</table>
</div>

<div id="table3" style="display:none;">
<table border="0" cellspacing="1" cellpadding="0" class="cls">
	<tr>
		<td class="td2" style="background:#F2F2F2;">序号</td>
		<td class="td2" style="background:#F2F2F2;">文案信息内容</td>
		<td class="td2" style="background:#F2F2F2;">添加时间</td>
		<td class="td2" style="background:#F2F2F2;">操作管理</td>
	</tr>
	<volist name="recom3" id="vo">
	<tr>
		<td class="td2">{$vo.id|default='&nbsp;'}</td>
		<td class="td3" id="id_{$vo.id}">{$vo.recom_cont|default='&nbsp;'}</td>
		<td class="td2">{$vo.postdate|default='&nbsp;'}</td>
		<td class="td2"><span style="margin-right:7px;"><a href="javascript:void(0);" onclick="Edit(3,{$vo.id})">【编辑】</a></span><a href="javascript:void(0);" onclick="Delete(3,{$vo.id})">【删除】</a></td>
	</tr>
	</volist>
</table>
</div>

<div id="table4" style="display:none;">
<table border="0" cellspacing="1" cellpadding="0" class="cls">
	<tr>
		<td class="td2" style="background:#F2F2F2;">序号</td>
		<td class="td2" style="background:#F2F2F2;">文案信息内容</td>
		<td class="td2" style="background:#F2F2F2;">添加时间</td>
		<td class="td2" style="background:#F2F2F2;">操作管理</td>
	</tr>
	<volist name="recom4" id="vo">
	<tr>
		<td class="td2">{$vo.id|default='&nbsp;'}</td>
		<td class="td3" id="id_{$vo.id}">{$vo.recom_cont|default='&nbsp;'}</td>
		<td class="td2">{$vo.postdate|default='&nbsp;'}</td>
		<td class="td2"><span style="margin-right:7px;"><a href="javascript:void(0);" onclick="Edit(4,{$vo.id})">【编辑】</a></span><a href="javascript:void(0);" onclick="Delete(4,{$vo.id})">【删除】</a></td>
	</tr>
	</volist>
</table>
</div>
</center>

<style type="text/css">
.table_recom {width:100%;height:100%;border:1px solid #000;}
.td10 {font-weight:bold;font-size:13px;text-align:center;height:30px;}
.td11 {text-align:center;height:170px;}
.td12 {text-align:center;font-size:12px;}
.td13 {color:red;font-size:12px;text-align:center;height:40px;}
</style>
<div id="_recom" style="position:absolute;top:0;left:0;background:#fff;width:400px;height:300px;display:none;">
<table border="0" cellspacing="0" cellpadding="0" class="table_recom">
	<form method="post" action="/index.php/Sj/Market/recommanage/action/addRecom/" id="add_form" onsubmit="return addRecomChk()">
	<tr>
		<td class="td10" id="edit_tit">添加推荐信息</td>
	</tr>
	<tr>
		<td class="td11"><textarea id="recom_cont" name="recom_cont" cols="50" rows="7" style="font-size:12px;" onfocus="if(this.value=='在此输入文案信息，字数控制在20字以内'){this.value='';}">在此输入文案信息，字数控制在20字以内</textarea></td>
	</tr>
	<tr>
		<td class="td12"><strong>选择文案类型：</strong><select name="recom_type" id="recom_type"><option value="0">请选择</option><option value="1">普通推荐文案</option><option value="2">已安装软件全部过滤推荐文案</option><option value="3">等待加载推荐文案</option><option value="4">下载、更新为空推荐文案</option></select></td>
	</tr>
	<tr>
		<td class="td13">注：文案中若需要调用变量，请在配置页面提前进行设定。</td>
	</tr>
	<tr>
		<td class="td13"><button style="margin-right:50px;" type="submit">提交</button><button onclick="popclose('_recom')" type="button">取消</button></td>
	</tr>
	</form>
</table>
</div>

<input type="hidden" id="cur_type" value="1" />
<script language="javascript">
var recom_type = <?php if($_GET['recom_type'] && is_numeric($_GET['recom_type'])) {echo "{$_GET['recom_type']}";} else { echo '1';} ?>;
showtb(recom_type);
$('#cur_type').val(recom_type);
function showtb(num) {
	for(var i=1;i<=4;i++) {
		if(i == num) {
			$("#td"+i).css('background','#FFFFCC');
			$("#table"+i).show();
			$("#cur_type").val(i);
		} else {
			$("#td"+i).css('background','#E4E4E4');
			$("#table"+i).hide();
		}
	}
}
function addRecomChk() {
	if($('#recom_cont').val() == '' || $('#recom_cont').val() == '在此输入文案信息，字数控制在20字以内') {
		alert("请填写推荐信息内容！");
		return false;
	}
	if($("#recom_cont").val().length > 20) {
		alert("推荐信息字数请控制在20字以内！");
		return false;
	}
	if($('#recom_type').val()==0) {
		alert("请选择文案类型！");
		return false;
	}
	return true;
}
function Delete(recom_type,id) {
	if(confirm("您确定要删除吗？")) {
		window.location="/index.php/Sj/Market/recommanage?action=delete&recom_type="+recom_type+"&id="+id;
		if(window.ActiveXObject) window.event.returnValue = false;
	}
}
function Edit(recom_type,id) {
	popup('_recom');
	$('#edit_tit').html('编辑推荐信息');
	$('#recom_cont').val($('#id_'+id).html());
	$('#cur_type').val(recom_type);
	$('#recom_type').val(recom_type);
	document.forms['add_form'].action='/index.php/Sj/Market/recommanage/action/edit/id/'+id+'/recom_type/'+recom_type;
}
</script>
<div id="bgdiv" style="position:absolute;display:none; left:0px; top:0px; width:100%; height:100%; filter:alpha(opacity=40);opacity:0.4; background-color:#000000; z-index:1000;"></div>
<script language="javascript">
function popup(id) {
	$("#bgdiv").css("display","block");
	$("#bgdiv").css({width:$(document).width()+"px",height:$(document).height()+"px"});

	$("#"+id).css({display:"block",position:"absolute",zIndex:"10001"});
	$("#"+id).css("top",($(window).height()-$("#"+id)[0].offsetHeight)/2+$(document).scrollTop()+"px");
	$("#"+id).css("left",($(window).width()-$("#"+id)[0].offsetWidth)/2+$(document).scrollLeft()+"px");

	if(id == '_recom') {
		$('#recom_type').val($('#cur_type').val());

	}
}
function popclose(id) {
	$("#"+id).css({display:"none"});
	$("#bgdiv").css({display:"none"});
}
</script>
</body>