<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="text/javascript" src="/Public/js/jquery-1.4.2.min.js"></script>
<style>
td{padding:5px;}
.red{color:red;}
.box_input tr td{text-align:left !important;font-size:14px;}
.box_input tr td input{ height:31px; width:130px; float:left;}
.green{color:green;}
.myradio{display:inline;height:auto !important;width:auto;}
.justfy{width:124px;}
</style>
</head>
<body>
<h5 class="yahei" style="padding-left:190px;">录入分站点下载计费<?php echo ($flexible_sys==2)?'月':'';?>限额</h5>
<form action="__URL__/add_download_config_show" id="" method="post" class="uform">
<input type="hidden" name="softname" value="{$softname}" id='softname'/>
<input type="hidden" name="package" value="{$package}" id='package'/>
	<table class="yahei box_input" style='width:600px;!important;'>
		<tr>
			<td class="justfy"><font color=red>*</font>&nbsp;&nbsp;产品包名:</td>
			<td><input type="text" name="package2" class="" id="package2"  onblur="get_soft()" style="width:200px;"></td>
		</tr>
		<tr>
			<td class="justfy"><font color=red></font><span style='margin-left:10px;'>&nbsp;软件名称:</span></td>
			<td><span id='softname2'></span></td>
		</tr>
		<tr>
			<td class="justfy"><font color=red>*</font>安智站点：</td>
		</tr>
		<tr>
			<td class="justfy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red>*</font>客户端：</td>
			<td style="width:150px;!important;"><input type="text" disabled="disabled" name="market_downloaded_one" class="" id="market_downloaded_one"  onblur="change_num('market_downloaded')"></td>
			<input type="hidden"  name="market_downloaded" class="" id="market_downloaded" value="{$arr[6]}" alt='{$arr[6]}'>
			<td align="left">
			<input type="radio" name="market_downloaded_two" style="width:30px;!important;" value="0" id="market_downloaded_two" checked onclick="change_status('market_downloaded','two')"/><input value='通用'style="width:40px;!important;background-color:white;border:0px" type="button">
			<input type="radio" name="market_downloaded_four" style="width:30px;!important;" value="0" id="market_downloaded_four" onclick="change_status('market_downloaded','four')" /><input value='自定义'style="width:50px;!important;background-color:white;border:0px" type="button">
        	</td>
		</tr>
		<tr>
			<td class="justfy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red>*</font>www站点：</td>
			<td style="width:150px;!important;"><input type="text" disabled="disabled" name="www_downloaded_one" class="" id="www_downloaded_one"  onblur="change_num('www_downloaded')"></td>
			<input type="hidden"  name="www_downloaded" class="" id="www_downloaded" value="{$arr[1]}" alt='{$arr[1]}'>
			<td align="left">
			<input type="radio" name="www_downloaded_two" style="width:30px;!important;" value="0" id="www_downloaded_two" checked onclick="change_status('www_downloaded','two')"/><input value='通用'style="width:40px;!important;background-color:white;border:0px" type="button">
			<input type="radio" name="www_downloaded_four" style="width:30px;!important;" value="0" id="www_downloaded_four" onclick="change_status('www_downloaded','four')" /><input value='自定义'style="width:50px;!important;background-color:white;border:0px" type="button">
        	</td>
		</tr>
		<tr>
			<td class="justfy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red>*</font>m站点：</td>
			<td><input type="text" name="m_downloaded_one" class="" id="m_downloaded_one" disabled="disabled" onblur="change_num('m_downloaded')"></td>
			<input type="hidden"  name="m_downloaded" class="" id="m_downloaded" value="{$arr[2]}" alt="{$arr[2]}">
			<td align="left">
			<input type="radio" name="m_downloaded_two" style="width:30px;!important;" value="0" id="m_downloaded_two" checked onclick="change_status('m_downloaded','two')"/><input  value='通用'style="width:40px;!important;background-color:white;border:0px" type="button">
			 <input type="radio" name="m_downloaded_four" style="width:30px;!important;" value="0" id="m_downloaded_four" onclick="change_status('m_downloaded','four')"/><input value='自定义'style="width:50px;!important;background-color:white;border:0px" type="button">
        </td>
		</tr>
		<tr>
			<td class="justfy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red>*</font>合作站点：</td>
			<td><input type="text" name="coop_downloaded_one" class="" id="coop_downloaded_one" disabled="disabled"  onblur="change_num('coop_downloaded')"></td>
			<input type="hidden"  name="coop_downloaded" class="" id="coop_downloaded" value="{$arr[3]}" alt="{$arr[3]}">
			<td align="left"> 
			<input type="radio" name="coop_downloaded_two" style="width:30px;!important;" value="0" id="coop_downloaded_two" checked onclick="change_status('coop_downloaded','two')"/><input  value='通用'style="width:40px;!important;background-color:white;border:0px" type="button">
			<input type="radio" name="coop_downloaded_four" style="width:30px;!important;" value="0" id="coop_downloaded_four" onclick="change_status('coop_downloaded','four')"/><input value='自定义'style="width:50px;!important;background-color:white;border:0px" type="button">
        </td>
		</tr>
		<tr>
			<td class="justfy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red>*</font>其他站点：</td>
			<td><input type="text" name="other_downloaded_one" class="" id="other_downloaded_one"  disabled="disabled" onblur="change_num('other_downloaded')"></td>
			<input type="hidden"  name="other_downloaded" class="" id="other_downloaded" value="{$arr[4]}" alt="{$arr[4]}">
			<td align="left"> 
			<input type="radio" name="other_downloaded_two" style="width:30px;!important;" value="0" id="other_downloaded_two" checked onclick="change_status('other_downloaded','two')"/><input  value='通用'style="width:40px;!important;background-color:white;border:0px" type="button">
			<input type="radio" name="other_downloaded_four" style="width:30px;!important;" value="0" id="other_downloaded_four" onclick="change_status('other_downloaded','four')"/><input value='自定义'style="width:50px;!important;background-color:white;border:0px" type="button">
        </td>
		</tr>
		<!-- <tr>
			<td class="justfy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red>*</font>商务下载：</td>
			<td style="width:150px;!important;"><input type="text" disabled="disabled" name="business_downloaded_one" class="" id="business_downloaded_one"  onblur="change_num('business_downloaded')"></td>
			<input type="hidden"  name="business_downloaded" class="" id="business_downloaded" value="{$arr[7]}" alt='{$arr[7]}'>
			<td align="left">
			<input type="radio" name="business_downloaded_two" style="width:30px;!important;" value="0" id="business_downloaded_two" checked onclick="change_status('business_downloaded','two')"/><input value='通用'style="width:40px;!important;background-color:white;border:0px" type="button">
			<input type="radio" name="business_downloaded_four" style="width:30px;!important;" value="0" id="business_downloaded_four" onclick="change_status('business_downloaded','four')" /><input value='自定义'style="width:50px;!important;background-color:white;border:0px" type="button">
        	</td>
		</tr> -->
		<tr>
			<td class="justfy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red>*</font>智友下载：</td>
			<td style="width:150px;!important;"><input type="text" disabled="disabled" name="yoo_downloaded_one" class="" id="yoo_downloaded_one"  onblur="change_num('yoo_downloaded')"></td>
			<input type="hidden"  name="yoo_downloaded" class="" id="yoo_downloaded" value="{$arr[8]}" alt='{$arr[8]}'>
			<td align="left">
			<input type="radio" name="yoo_downloaded_two" style="width:30px;!important;" value="0" id="yoo_downloaded_two" checked onclick="change_status('yoo_downloaded','two')"/><input value='通用'style="width:40px;!important;background-color:white;border:0px" type="button">
			<input type="radio" name="yoo_downloaded_four" style="width:30px;!important;" value="0" id="yoo_downloaded_four" onclick="change_status('yoo_downloaded','four')" /><input value='自定义'style="width:50px;!important;background-color:white;border:0px" type="button">
        	</td>
		</tr>
		<tr>
			<td class="justfy"><font color=red>*</font>第三方站点：</td>
		</tr>
		<tr>
			<td class="justfy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red>*</font>拇指玩：</td>
			<td><input type="text" name="finger_play_downloaded_one" class="" id="finger_play_downloaded_one" disabled="disabled"  onblur="change_num('finger_play_downloaded')"></td>
			<input type="hidden"  name="finger_play_downloaded" class="" id="finger_play_downloaded" value="{$arr[5]}" alt="{$arr[5]}">
			<td align="left">
			 <input type="radio" name="finger_play_downloaded_two" style="width:30px;!important;" value="0" id="finger_play_downloaded_two" checked onclick="change_status('finger_play_downloaded','two')"/><input  value='通用'style="width:40px;!important;background-color:white;border:0px" type="button">
			<input type="radio" name="finger_play_downloaded_four" style="width:30px;!important;" value="0" id="finger_play_downloaded_four" onclick="change_status('finger_play_downloaded','four')"/><input value='自定义'style="width:50px;!important;background-color:white;border:0px" type="button">
        </td>
		</tr>
		<tr>
			<td class="justfy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red>*</font>移动MM：</td>
			<td style="width:150px;!important;"><input type="text" disabled="disabled" name="mm_downloaded_one" class="" id="mm_downloaded_one"  onblur="change_num('mm_downloaded')"></td>
			<input type="hidden"  name="mm_downloaded" class="" id="mm_downloaded" value="{$arr[9]}" alt='{$arr[9]}'>
			<td align="left">
			<input type="radio" name="mm_downloaded_two" style="width:30px;!important;" value="0" id="mm_downloaded_two" checked onclick="change_status('mm_downloaded','two')"/><input value='通用'style="width:40px;!important;background-color:white;border:0px" type="button">
			<input type="radio" name="mm_downloaded_four" style="width:30px;!important;" value="0" id="mm_downloaded_four" onclick="change_status('mm_downloaded','four')" /><input value='自定义'style="width:50px;!important;background-color:white;border:0px" type="button">
        	</td>
		</tr>
		<!-- <tr>
			<td class="justfy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red>*</font>安智ORM：</td>
			<td style="width:150px;!important;"><input type="text" disabled="disabled" name="channel_downloaded_one" class="" id="channel_downloaded_one"  onblur="change_num('channel_downloaded')"></td>
			<input type="hidden"  name="channel_downloaded" class="" id="channel_downloaded" value="{$arr[10]}" alt='{$arr[10]}'>
			<td align="left">
			<input type="radio" name="channel_downloaded_two" style="width:30px;!important;" value="0" id="channel_downloaded_two" checked onclick="change_status('channel_downloaded','two')"/><input value='通用'style="width:40px;!important;background-color:white;border:0px" type="button">
			<input type="radio" name="channel_downloaded_four" style="width:30px;!important;" value="0" id="channel_downloaded_four" onclick="change_status('channel_downloaded','four')" /><input value='自定义'style="width:50px;!important;background-color:white;border:0px" type="button">
        	</td>
		</tr>
		<tr>
			<td class="justfy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red>*</font>数据放量：</td>
			<td style="width:150px;!important;"><input type="text" disabled="disabled" name="da_downloaded_one" class="" id="da_downloaded_one"  onblur="change_num('da_downloaded')"></td>
			<input type="hidden"  name="da_downloaded" class="" id="da_downloaded" value="{$arr[11]}" alt='{$arr[11]}'>
			<td align="left">
			<input type="radio" name="da_downloaded_two" style="width:30px;!important;" value="0" id="da_downloaded_two" checked onclick="change_status('da_downloaded','two')"/><input value='通用'style="width:40px;!important;background-color:white;border:0px" type="button">
			<input type="radio" name="da_downloaded_four" style="width:30px;!important;" value="0" id="da_downloaded_four" onclick="change_status('da_downloaded','four')" /><input value='自定义'style="width:50px;!important;background-color:white;border:0px" type="button">
        	</td>
		</tr> -->
		<tr>
			<td class="justfy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red>*</font>生效<if condition="($flexible_sys eq 1) ">日期<else/>月份</if>：</td>
			<td>
			<if condition="($flexible_sys eq 1) "> 
				<input type="text" name="op_tm" class="Wdate" id="op_tm" required onClick="WdatePicker({startDate:'%y-%M-%d', dateFmt:'yyyy-MM-dd'})" style="width:180px;!important;">
			<else/>
				<input type="text" name="op_tm" class="Wdate" id="op_tm" required onClick="WdatePicker({startDate:'%y-%M', dateFmt:'yyyy-MM'})" style="width:180px;!important;">
			</if>
			</td>
            <td style="color:red;"><div id='op_tm_error'></div></td>
		</tr>
	</table>

	<table class="yahei box_input" id="insertBeforeHere">
		<tr>
			<td class="justfy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;备&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注：</td>
			<td><textarea style="width:350px;height:100px;" name="remark" id="remark"></textarea></td>
			<td style="color:red;"><div id='remark_error'></div></td>
		</tr>

	</table>
	<div style="margin:10px auto;padding:0px 90px;">
	<button class=" btn btn-sm btn-success yahei"  style="padding-left:30px;padding-right:30px;margin-left:40px;" type="submit" onclick="javascript:return checkBeforeSubmit();">保存</button>
	<button class=" btn btn-sm btn-default yahei"  style="padding-left:30px;padding-right:30px;margin-left:40px;" type="button" onClick="javascript:tb_remove();">取消</button>
	</div>
</form>
<script>
function checkBeforeSubmit()
{
	var i= 1;
	if($("#op_tm").val().length == 0 || $("#op_tm").val() == "")
	{
		$('#op_tm_error').html("请先填写生效日期！");
		return false;
	}
	if($("#remark").val().length >100)
	{
		$('#remark_error').html("100个字符以内");
		return false;
	}
	return true;
}
function change_status(from,id){
	$("input[name^="+from+"]").attr('checked',false);
	$("input[name="+from+"_"+id+"]").attr('checked','checked');
	if(id=='four'){
		$('#'+from+'_one').attr('disabled','');
		// $('#'+from).val($('#'+from+'_one').val());
	}else if(id=='two'){
		$('#'+from+'_one').attr('disabled','disabled');
		$('#'+from+'_one').val('');
		$('#'+from).val($('#'+from).attr('alt'));
		// $('#'+from+'_one').val($('#'+from+'_one').attr('alt'));
		// $('#'+from).val($('#'+from+'_one').attr('alt'));
	}
}
function change_num(from){
	var str=$('#'+from+'_one').val();
	if(str){
		if(isNaN(str))
		{
			alert("下载限额必须是非负整数！");
			$('#'+from+'_one').val($('#'+from+'_one').attr('alt'));
			$('#'+from).val($('#'+from+'_one').attr('alt'));
			return false;
		}else if(!(/^(0|[1-9]\d*)$/.test(str))){
			alert("下载限额必须是非负整数！");
			$('#'+from+'_one').val($('#'+from+'_one').attr('alt'));
			$('#'+from).val($('#'+from+'_one').attr('alt'));
			return false;
		}
		$('#'+from).val($('#'+from+'_one').val());
	}else{
		$('#'+from+'_one').val($('#'+from+'_one').attr('alt'));
		$('#'+from).val($('#'+from+'_one').attr('alt'));
		return true;
	}
	return true;
}

function get_soft(){
    var package = $("#package2").val();
    if(package!=''){
        $.ajax({
            type: "POST",
            url: "__URL__/get_soft_info",
            data: "package="+package,
            dataType:"json",
            success:function(data){
                if(data.code==0){
                    alert(data.msg);
                    $("#softname2").html('');
                    $("#softname").val('');
                    $("#package").val('');
                    $("#contract_id").val('');
                }else{
                    $("#softname2").html(data.contract_data.softname);
                    $("#softname").val(data.contract_data.softname);
                    $("#package").val(data.contract_data.package);
                    $("#contract_id").val(data.contract_data.id);
                }
            }
        });
    }else{
        alert('包名不能为空');
        $("#softname").html('');
        $("#contract_id").val('');
    }
}
</script>

<!-- 主页面结束 -->
</body>
</html>